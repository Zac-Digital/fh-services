name: DotNet Stryker (Full Report)
on:
  push:           # TODO: Temporary while Developing
    branches:     # TODO: Temporary while Developing
      - 'FHB-875' # TODO: Temporary while Developing
  # TODO: Schedule CRON Job
  pull_request:
    paths:
      - '.github/workflows/stryker.yml'

concurrency:
  group: "${{ github.workflow }}-${{ github.ref }}"
  cancel-in-progress: true

jobs:
  stryker-matrix:
    name: Stryker - ${{ matrix.job_name }}
    strategy: 
      fail-fast: false
      matrix:
        working_directory:
          [
            service/notification-api/tests/FamilyHubs.Notification.Api.Contracts.Tests,
            service/notification-api/tests/FamilyHubs.Notification.FunctionalTests,
            service/notification-api/tests/FamilyHubs.Notification.IntegrationTests,
            service/notification-api/tests/FamilyHubs.Notification.UnitTests,
            
            service/idam-api/tests/FamilyHubs.Idam.Api.FunctionalTests,
            service/idam-api/tests/FamilyHubs.Idam.Api.UnitTests,
            service/idam-api/tests/FamilyHubs.Idam.Core.IntegrationTests,
            
            service/service-directory-api/tests/FamilyHubs.ServiceDirectory.Api.FunctionalTests,
            service/service-directory-api/tests/FamilyHubs.ServiceDirectory.Core.IntegrationTests,
            service/service-directory-api/tests/FamilyHubs.ServiceDirectoryApi.UnitTests,
            
            service/referral-api/tests/FamilyHubs.ReferralApi.FunctionalTests,
            service/referral-api/tests/FamilyHubs.ReferralApi.IntegrationTests,
            service/referral-api/tests/FamilyHubs.ReferralApi.UnitTests,
            
            service/report-api/tests/FamilyHubs.ReportApi.FunctionalTests,
            service/report-api/tests/FamilyHubs.ReportApi.UnitTests,
            
            function/open-referral-function/tests/FamilyHubs.OpenReferral.UnitTests,
            
            ui/connect-ui/tests/FamilyHubs.ReferralUi.UnitTests,
            
            ui/find-ui/tests/FamilyHubs.ServiceDirectory.UnitTests,
            
            ui/idam-maintenance-ui/tests/FamilyHubs.Idams.Maintenance.UnitTests,
            
            ui/manage-ui/Test/FamilyHubs.ServiceDirectory.Admin.Web.IntegrationTests,
            ui/manage-ui/Test/FamilyHubs.ServiceDirectory.Admin.Web.UnitTests,
            
            shared/referral-shared/tests/FamilyHubs.ReferralService.Shared.Tests,
            
            shared/service-directory-shared/tests/FamilyHubs.ServiceDirectory.UnitTests,
            
            shared/shared-kernel/tests/EntityFrameworkCore.DataEncryption.Test,
            shared/shared-kernel/tests/fh-shared-kernel.unit-tests,
            
            shared/web-components/tests/FamilyHubs.SharedKernel.Razor.UnitTests
          ]
        include:
          - working_directory: service/notification-api/tests/FamilyHubs.Notification.Api.Contracts.Tests
            job_name: "Notification API - Contracts - Unit Tests"
          - working_directory: service/notification-api/tests/FamilyHubs.Notification.FunctionalTests
            job_name: "Notification API - Functional Tests"
          - working_directory: service/notification-api/tests/FamilyHubs.Notification.IntegrationTests
            job_name: "Notification API - Integration Tests"
          - working_directory: service/notification-api/tests/FamilyHubs.Notification.UnitTests
            job_name: "Notification API - Unit Tests"
            
          - working_directory: service/idam-api/tests/FamilyHubs.Idam.Api.FunctionalTests
            job_name: "IdAM API - Functional Tests"
          - working_directory: service/idam-api/tests/FamilyHubs.Idam.Api.UnitTests
            job_name: "IdAM API - Unit Tests"
          - working_directory: service/idam-api/tests/FamilyHubs.Idam.Core.IntegrationTests
            job_name: "IdAM API - Integration Tests"
            
          - working_directory: service/service-directory-api/tests/FamilyHubs.ServiceDirectory.Api.FunctionalTests
            job_name: "Service Directory API - Functional Tests"
          - working_directory: service/service-directory-api/tests/FamilyHubs.ServiceDirectory.Core.IntegrationTests
            job_name: "Service Directory API - Integration Tests"
          - working_directory: service/service-directory-api/tests/FamilyHubs.ServiceDirectoryApi.UnitTests
            job_name: "Service Directory API - Unit Tests"
            
          - working_directory: service/referral-api/tests/FamilyHubs.ReferralApi.FunctionalTests
            job_name: "Referral API - Functional Tests"
          - working_directory: service/referral-api/tests/FamilyHubs.ReferralApi.IntegrationTests
            job_name: "Referral API - Integration Tests"
          - working_directory: service/referral-api/tests/FamilyHubs.ReferralApi.UnitTests
            job_name: "Referral API - Unit Tests"
            
          - working_directory: service/report-api/tests/FamilyHubs.ReportApi.FunctionalTests
            job_name: "Report API - Functional Tests"
          - working_directory: service/report-api/tests/FamilyHubs.ReportApi.UnitTests
            job_name: "Report API - Unit Tests"
            
          - working_directory: function/open-referral-function/tests/FamilyHubs.OpenReferral.UnitTests
            job_name: "Open Referral Function - Unit Tests"
            
          - working_directory: ui/connect-ui/tests/FamilyHubs.ReferralUi.UnitTests
            job_name: "Connect UI - Unit Tests"
            
          - working_directory: ui/find-ui/tests/FamilyHubs.ServiceDirectory.UnitTests
            job_name: "Find UI - Unit Tests"
            
          - working_directory: ui/idam-maintenance-ui/tests/FamilyHubs.Idams.Maintenance.UnitTests
            job_name: "IdAM Maintenance UI - Unit Tests"
            
          - working_directory: ui/manage-ui/Test/FamilyHubs.ServiceDirectory.Admin.Web.IntegrationTests
            job_name: "Manage UI - Integration Tests"
          - working_directory: ui/manage-ui/Test/FamilyHubs.ServiceDirectory.Admin.Web.UnitTests
            job_name: "Manage UI - Unit Tests"
            
          - working_directory: shared/referral-shared/tests/FamilyHubs.ReferralService.Shared.Tests,
            job_name: "Referral Shared - Unit Tests"
            
          - working_directory: shared/service-directory-shared/tests/FamilyHubs.ServiceDirectory.UnitTests
            job_name: "Service Directory Shared - Unit Tests"
            
          - working_directory: shared/shared-kernel/tests/EntityFrameworkCore.DataEncryption.Test
            job_name: "Shared Kernel - Data Encryption - Unit Tests"
          - working_directory: shared/shared-kernel/tests/fh-shared-kernel.unit-tests
            job_name: "Shared Kernel - Unit Tests"
            
          - working_directory: shared/web-components/tests/FamilyHubs.SharedKernel.Razor.UnitTests
            job_name: "Web Components Shared - Unit Tests"
    uses: ./.github/workflows/stryker-template.yml
    with:
      working_directory: ${{ matrix.working_directory }}
      job_name: ${{ matrix.job_name }}